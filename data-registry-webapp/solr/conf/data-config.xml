<?xml version="1.0" encoding="UTF-8"?>
<dataConfig>
    <dataSource name="registry-ds"
                type="JdbcDataSource"
                driver="org.postgresql.Driver"
                url="jdbc:postgresql://localhost/registry"
                user="registry"
                password="registry"
                readOnly="true"
                autoCommit="false"
                transactionIsolation="TRANSACTION_READ_COMMITTED"
                holdability="CLOSE_CURSORS_AT_COMMIT"/>

    <document name="collections">
        <entity name="subject" dataSource="registry-ds"
                query="SELECT * FROM subject WHERE isactive = true">
        </entity>
        <entity name="collectionversion" dataSource="registry-ds"
                query="SELECT v.title, v.description, c.id FROM collectionversion as v, collection as c WHERE c.isactive = true AND c.published_id = v.id">
            <field column="c.id" name="id"/>
            <field column="v.title" name="collectiontitle"/>
            <field column="v.description" name="collectiondescription"/>
        </entity>
        <entity name="agentversion" dataSource="registry-ds"
                query="SELECT * FROM agentversion WHERE isactive = true">
            <field column="title" name="agenttitle"/>
            <field column="description" name="agentdescription"/>
        </entity>
        <entity name="serviceversion" dataSource="registry-ds"
                query="SELECT * FROM serviceversion WHERE isactive = true">
            <field column="title" name="servicetitle"/>
            <field column="description" name="servicedescription"/>
        </entity>
        <entity name="activityversion" dataSource="registry-ds"
                query="SELECT * FROM activityversion WHERE isactive = true">
            <field column="title" name="activitytitle"/>
            <field column="description" name="activitydescription"/>
        </entity>
        <entity name="newcollections" dataSource="registry-ds"
                query="select v.title, v.description, c.created from collection as c, collectionversion as v where c.published_id = v.id and c.isactive = true ORDER by c.created DESC LIMIT 5">
            <field column="v.title" name="newcollectiontitle"/>
            <field column="v.description" name="newcollectiondescription"/>
            <field column="c.created" name="newcollectioncreated"/>
        </entity>
    </document>
</dataConfig>